 @using Microsoft.AspNetCore.Components.Routing
 @using System.Reflection
@using MoLibrary.UI.Components.Layout
@using MoLibrary.UI.UICore
@inject IUIComponentRegistry UIRegistry

<Router AppAssembly="@typeof(MoRouter).Assembly" 
        AdditionalAssemblies="@GetAdditionalAssemblies()">
    <Found>
        <RouteView RouteData="@context" DefaultLayout="@typeof(MoMainLayout)" />
        <FocusOnNavigate RouteData="@context" Selector="h1" />
    </Found>
    <NotFound>
        <PageTitle>Not found</PageTitle>
        <LayoutView Layout="@typeof(MoMainLayout)">
            <MudAlert Severity="Severity.Error">
                <AlertContent>
                    <MudText Typo="Typo.h6">页面未找到</MudText>
                    <MudText>抱歉，请求的页面不存在。</MudText>
                </AlertContent>
            </MudAlert>
        </LayoutView>
    </NotFound>
</Router>

@code {
    private Assembly[] GetAdditionalAssemblies()
    {
        var assemblies = new HashSet<Assembly>();
        
        // 添加包含注册页面的程序集
        foreach (var page in UIRegistry.GetRegisteredPages())
        {
            assemblies.Add(page.ComponentType.Assembly);
        }
        
        return assemblies.ToArray();
    }
}